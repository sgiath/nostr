# Nostr Relay Configuration
# Copy to config/relay.toml (dev) or ~/.config/nostr-relay/relay.toml (prod).
# All values are optional — omitted fields keep compile-time defaults.
# Override the file path with the NOSTR_RELAY_CONFIG environment variable.

[relay]
name = "My Nostr Relay"
description = "A personal relay."
# pubkey = "hex-encoded-32-byte-pubkey"
# self_pub = "hex-encoded-32-byte-relay-pubkey"
# self_sec = "hex-encoded-32-byte-relay-seckey"
# contact = "mailto:admin@example.com"
# url = "wss://relay.example.com"          # used for NIP-42 relay tag validation

[server]
ip = "127.0.0.1"
port = 4000

[database]
# path = "~/.local/share/nostr-relay/relay.db"

[limitation]
max_message_length = 8000000
max_subscriptions = 100
max_limit = 10_000
max_subid_length = 100
max_event_tags = 100
max_content_length = 8192
min_pow_difficulty = 0
# auth_required is derived from [auth].required
payment_required = false
restricted_writes = false
created_at_lower_limit = 31536000
created_at_upper_limit = 900
default_limit = 500

# Internal relay policy (not part of NIP-11 metadata)
[relay_policy]
# Minimum prefix length for REQ/COUNT `ids` and `authors` filters.
# - Prefixes shorter than this are rejected to avoid expensive broad scans.
# - Full 64-char hex ids/pubkeys are always accepted.
# Example: with min_prefix_length = 4, "abc" is rejected, "abcd" is allowed.
min_prefix_length = 4

# NIP-42 Authentication
# The relay always sends an AUTH challenge on every new connection so clients
# can optionally authenticate. When required = true, clients MUST respond with
# a signed kind-22242 event before any EVENT/REQ/COUNT is accepted.
# Unauthenticated connections are closed after timeout_seconds.
#
# mode controls access-list behaviour:
#   "none"      — any authenticated pubkey is accepted (default)
#   "whitelist" — only pubkeys in the whitelist are accepted
#   "denylist"  — all pubkeys except those in the denylist are accepted

[auth]
# required = false
# mode = "none"
# whitelist = ["hex-pubkey-1", "hex-pubkey-2"]
# denylist  = ["hex-pubkey-3"]

# NIP-29 Relay-based Groups
# Disabled by default. When enabled, the relay enforces group write/read policy
# and may generate relay-signed group state events.

[nip29]
# enabled = false
# allow_unmanaged_groups = true
# publish_group_members = false
# publish_group_roles = true

[nip29.optional_checks]
# enforce_group_id_charset = false
# enforce_previous_refs = false
# min_previous_refs = 0
# enforce_previous_known_events = false
# enforce_late_publication = false
# max_event_age_seconds = 86400
# require_invite_for_closed_groups = false

[nip29.joins]
# auto_accept = false
# allow_pending = true

[nip29.roles]
# admin = ["put_user", "remove_user", "edit_metadata", "delete_event", "create_invite", "delete_group"]
# moderator = ["delete_event"]
